# ---------------------------------------
# DJANGO SECURITY CONFIGURATION
# ---------------------------------------

# IMPORTANT: DEBUG MUST NEVER default to True
# Production deployments MUST set this explicitly
DEBUG=False

# Generate a real secret key before deploying
SECRET_KEY=replace-with-a-secure-random-secret-key

# ---------------------------------------
# HOST CONFIGURATION
# ---------------------------------------
# MUST be explicitly set in production
# NEVER PUT "*"
ALLOWED_HOSTS=127.0.0.1,localhost

# CORS â€” add frontend domains here
CORS_ALLOWED_ORIGINS=http://localhost:5173,https://pss-frontend-ebon.vercel.app
CORS_ALLOW_ALL_ORIGINS=False

# ---------------------------------------
# DATABASE (Render/Production will override)
# ---------------------------------------
DB_NAME=pss_database
DB_USER=your_db_user
DB_PASSWORD=your_db_password
DB_HOST=localhost
DB_PORT=5432
DB_SSL=False

# -----------------------------------------------------------------------------
# PII Encryption Key (POPIA Compliance)
# -----------------------------------------------------------------------------
# Generate with:
# python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
FIELD_ENCRYPTION_KEY=

# -----------------------------------------------------------------------------
# Security Settings (Production)
# -----------------------------------------------------------------------------
SECURE_SSL_REDIRECT=True
CSRF_COOKIE_SECURE=True
SESSION_COOKIE_SECURE=True
SECURE_HSTS_SECONDS=31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS=True
SECURE_HSTS_PRELOAD=True

# CSRF Trusted Origins (Production)
CSRF_TRUSTED_ORIGINS=https://your-frontend-domain.com,https://pss-frontend-ebon.vercel.app

# -----------------------------------------------------------------------------
# CAPTCHA Configuration (SCRUM-120 - Brute Force Protection)
# -----------------------------------------------------------------------------
# Enable/disable CAPTCHA (useful for testing)
CAPTCHA_ENABLED=True

# CAPTCHA provider ('recaptcha', 'hcaptcha', 'turnstile')
CAPTCHA_PROVIDER=recaptcha

# Failed login attempts before requiring CAPTCHA
CAPTCHA_TRIGGER_THRESHOLD=3

# Cache timeout for failed attempts (seconds, default: 900 = 15 minutes)
CAPTCHA_FAILED_LOGIN_TIMEOUT=900

# Google reCAPTCHA v3 Keys
# Get yours at: https://www.google.com/recaptcha/admin/create
RECAPTCHA_PUBLIC_KEY=your_recaptcha_site_key_here
RECAPTCHA_PRIVATE_KEY=your_recaptcha_secret_key_here

# reCAPTCHA v3 score threshold (0.0-1.0, higher = more strict)
# 0.0 = likely bot, 1.0 = likely human
RECAPTCHA_REQUIRED_SCORE=0.5

# Admin IPs that bypass CAPTCHA (optional, comma-separated)
CAPTCHA_BYPASS_IPS=

# -----------------------------------------------------------------------------
# Development Overrides
# -----------------------------------------------------------------------------
# DEBUG=True
# ALLOWED_HOSTS=127.0.0.1,localhost
# SECURE_SSL_REDIRECT=False
# CSRF_COOKIE_SECURE=False
# SESSION_COOKIE_SECURE=False
# SECURE_HSTS_SECONDS=0
# CSRF_TRUSTED_ORIGINS=http://localhost:5173,http://127.0.0.1:5173
# CAPTCHA_ENABLED=False  # Disable CAPTCHA for development
